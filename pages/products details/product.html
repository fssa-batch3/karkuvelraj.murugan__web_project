<!DOCTYPE html>
<html lang="en">

    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Document</title>
        <link rel="stylesheet" href="../../assets/css/style.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    </head>
   
    <body>          
        
        <section class="product-details">
            <div class="product">
                <div class="gold">

                </div>
                <div class="gape" ></div>
                <div class="gape1"></div>
                <div class="gape2"></div>
            </div>
            <div class="details">
                <h3 id="category" ></h3>
                <h3 id="prod-type"></h3>
                <!-- <div class="rating">
                    <i class="fa fa-star" style="color:goldenrod"></i>
                </div> -->
                <span class="shoe-type"></span>
                <h5></h5>
                <div class="size-container">
                    <span class="size">
                        <p id="size-s"></p>
                    </span>
                    <span class="size">
                        <p id="size-M"></p>
                    </span>
                    <span class="size">
                        <p id="size-L"></p>
                    </span>
                    <span class="size">
                        <p id="size-XL"></p>
                    </span>
                </div>
                <h4 class="rate"></h4>
                <p id="current" class="doller"></p>
                <span id="original" class="del"></span>
                <span id="offer"
                    class="discount"></span>
                <!-- <div class="rating-star">
                    <i class="fa fa-star"></i>
                    <i class="fa fa-star"></i>
                    <i class="fa fa-star"></i>
                    <i class="fa fa-star"></i>
                </div> -->
                <strong>
                    <p id="about_item">About this product:</p>
                </strong>

                <p id="des_details"></p>

                <span class="shopping">
                    <a href="">
                        <i class="fa fa-shopping-cart" style="color:goldenrod"></i>
                    </a>

                </span>

                <button id="add_to_cart" class="cart"></button>
                <i class="arrow">&#10148;
                </i>
                <!-- <a href=`../checkout page/checout.html?puid=${product_unique_id}`> -->
                    <button id="add_to_buy" class="order"></button>
                <!-- </a> -->
            </div>



        </section>
        <footer class="footer_container">
            <div class="f-1">
               <h4>About</h4>
               <h4>Policy</h4>
               <h4>Terms</h4>
               <p>Trusted by more than 1 Crore Indians <br>
                Cash on Delivery | Free Delivery</p>
            </div>
            <div class="middle">
                <img class="footer_logo" src="../../assets/images/logo-transparent-png.png" alt="" width="90px">                    
              <h4>Be sure to take a look at <br> our terms of Use and Privacy Policy</h4>
            </div>
            <div class="f-2">
              <h4>Contact</h4>

              <i class="fa fa-envelope"> <label for="">karkuvelraj60@gmail.com</label> </i> <br> 
              <i class="fa fa-phone"></i>+91 9092381410<br>
              <i class="fa fa-facebook-f"></i>
              <i class="fa fa-youtube-play"></i>
              <i class="fa fa-twitter"></i>
              <i class="fa fa-instagram"></i>
            </div>
               
        </footer>
     
      
        <script>

        
    const urlParams = new URLSearchParams(window.location.search);

    const product_unique_id = urlParams.get("product_uniqueId");

    const product = JSON.parse(localStorage.getItem("product_details"));

    const unique_product = product.filter((e) => e.unique_id == product_unique_id);
    console.log(unique_product);

    img1 = document.createElement("img");
    img1.setAttribute("src", unique_product[0].image1);
    img1.setAttribute("alt", "shoe");
    img1.setAttribute("width", "410");
    img1.setAttribute("height", "400");
    document.querySelector("div.gold").append(img1);

    img2 = document.createElement("img");
    img2.setAttribute("src", unique_product[0].image2);
    // img2.setAttribute(" onclick",unique_product[0].image2);
    img2.setAttribute("alt", "shoe");
    img2.setAttribute("width", "100px");
    img2.setAttribute("height", "80px");
    document.querySelector("div.gape").append(img2);

    img3 = document.createElement("img");
    img3.setAttribute("src", unique_product[0].image3);
    // img2.setAttribute("onclick",big(unique_product[0].image3));
    img3.setAttribute("alt", "shoe");
    img3.setAttribute("width", "100px");
    img3.setAttribute("height", "80px");
    document.querySelector("div.gape1").append(img3);

    img4 = document.createElement("img");
    img4.setAttribute("src", unique_product[0].image4);
    // img2.setAttribute(" onclick",unique_product[0].image4);
    img4.setAttribute("alt", "shoe");
    img4.setAttribute("width", "100px");
    img4.setAttribute("height", "80px");
    document.querySelector("div.gape2").append(img4);

    category = document.querySelector("h3#category");
    category.innerText = unique_product[0].name;

    category = document.querySelector("h3#prod-type");
    category.innerText = unique_product[0].type;

  

    category = document.querySelector("h5");
    category.innerText = "Choose Size:";

    category = document.querySelector("p#size-s");
    category.innerText = "s";

    category = document.querySelector("p#size-M");
    category.innerText = "M";

    category = document.querySelector("p#size-L");
    category.innerText = "L";

    category = document.querySelector("p#size-XL");
    category.innerText = "XL";

    category = document.querySelector("h4");
    category.innerText = "price:";

    category = document.querySelector("p#current");
    category.innerText =unique_product[0].current_price;

    category = document.querySelector("span#original");
    category.innerText = unique_product[0].price;

    category = document.querySelector("span#offer");
    category.innerText = (unique_product[0].discount+'%');

    category = document.querySelector("p#des_details");
    category.innerText = unique_product[0].description;

    category = document.querySelector("button#add_to_cart");
    category.setAttribute("data-id", unique_product[0].unique_id);
    category.innerText = "Add To Cart";

    category = document.querySelector("button#add_to_buy");
    category.setAttribute("data-id", unique_product[0].unique_id);
    category.innerText = "Buy now";

    // ADD TO CART

    const cart = document.querySelector("#add_to_cart");

cart.addEventListener("click", function () {
  const product_id = this.dataset.id;

  localStorage.setItem("cart_id", JSON.stringify(product_id));
//   console.log(product_id)

  const uid = JSON.parse(localStorage.getItem("userId"));
  const userlist = JSON.parse(localStorage.getItem("user_list"));

  const users =
    userlist.length &&
        JSON.parse(localStorage.getItem("user_list")).some(
          (data) => data.user_email === uid
    );

  if (!users) {
        alert("you are not logged in");
  } else {
        const product_id = JSON.parse(localStorage.getItem("cart_id"));
        const product_list = JSON.parse(localStorage.getItem("product_details"));
        const products = product_list.find((e) => e.unique_id === product_id);
        const cart_products = JSON.parse(localStorage.getItem("cart")) || [];


        const already_cart =
          cart_products.length &&
          JSON.parse(localStorage.getItem("cart")).some(
            (data) => data.productid === product_id && data.userid === uid
      );

        if (already_cart) {
          alert("This product has already been added to your cart.");
        } else {
          alert("This product has been added to your cart.");
          cart_products.push({
            productid: products.unique_id,
            userid: uid,
            product_quantity: 1
          });
          localStorage.setItem("cart", JSON.stringify(cart_products));
          window.location.href = "../homepage/cart.html";
        }
  }
});
        //  MY ORDER PAGE  // 

        const buy =document.querySelector("#add_to_buy");

      buy.addEventListener("click" , function(){
        const product_id =this.dataset.id;

        // console.log(product_id)
        localStorage.setItem("order_id",JSON.stringify(product_id));
    //  console.log(product_id);
         

     const user_id = JSON.parse(localStorage.getItem("userId"));
  const user_lists = JSON.parse(localStorage.getItem("user_list"));

  const users =
  user_lists.length &&
        JSON.parse(localStorage.getItem("user_list")).some(
          (data) => data.user_email === user_id
    );
     console.log(users)

     if (!users) {
        alert("you are not logged in");
  } else {
        const order_id = JSON.parse(localStorage.getItem("order_id"));
        const product_list = JSON.parse(localStorage.getItem("product_details"));
        const products = product_list.find((e) => e.unique_id === order_id);
        const ordered_products = JSON.parse(localStorage.getItem("ordered-product")) || [];

        const already_ordered =
        ordered_products.length &&
          JSON.parse(localStorage.getItem("order_id")).some(
            (data) => data.product_id === order_id && data.userid === user_id
      );

        if (already_ordered) {
          alert("This product has already been Oredered.");
        } else {
          alert("This product has been Going to checkout page.");
          window.location.href = `../checkout page/checout.html?puid=${product_unique_id}`;
        }
  }
      });
    


  
  </script>
<script src="../../assets/header.js"></script>  
    </body>

</html>